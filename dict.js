const input=document.getElementById("search"),$submit=document.getElementById("submit-btn"),$match=document.getElementById("match-list"),$display=document.getElementById("display"),instruction=document.querySelector("#instruction"),$filter=async e=>{const n=await fetch("https://malayalamozhi.github.io/mikuti/mal.json");let t=(await n.json()).filter(n=>{const t=new RegExp(`^${e}`,"gi");return n.en.match(t)||n.ml.match(t)||n.other.match(t)||n.san.match(t)});e.length<=1&&(t=[],$match.style.display="none",$display.innerHTML="",$display.style.display="none",window.localStorage.clear()),outputMatches(t)},outputMatches=e=>{if(e.length>0){var n=input.value.replace(/\s/g),t={english:/^[a-zA-Z]+$/,malayalam:/[\u0D00-\u0D7F]/};Object.entries(t);Object.entries(t).forEach(([t,i])=>{if(1==i.test(n))if("english"===t){const n=e.map(e=>`<li class="filter-words"><span>${e.en}</span></li>\n`).join("");$match.innerHTML=n,$match.style.display="block"}else{const n=e.map(e=>`<li class="filter-words"><span>${e.ml} ${e.san}</span></li>\n`).join("");$match.innerHTML=n,$match.style.display="block"}})}};let url="https://malayalamozhi.github.io/mikuti/mal.json";function findWords(){fetch(url).then(e=>e.json()).then(e=>{e.filter(function(e){if(e.en==input.value){$display.style.display="block";var n=document.createElement("h3"),t=document.createElement("p"),i=document.createElement("div"),a=document.createElement("p");if(i.appendChild(a),0!=e.other.length)(d=document.createElement("p")).innerHTML="<span>related</span> "+e.other,i.appendChild(d);if(0!=e.otheren.length)(s=document.createElement("p")).innerHTML="<span>related english words</span> "+e.otheren,i.appendChild(s);if(0!=e.example.length)(r=document.createElement("p")).innerHTML="<span>example</span> "+e.example,i.appendChild(r);if(0!=e.MalExplanation)(c=document.createElement("p")).innerHTML="<span> വിവരണം</span> "+e.MalExplanation,i.appendChild(c);if(0!=e.san.length)(o=document.createElement("p")).innerHTML="<span>sanskritised malayalam</span> "+e.san,i.appendChild(o);function l(){"prefix"===e.type?n.innerHTML=e.en+"-":"suffix"===e.type&&(n.innerHTML="-"+e.en)}n.innerHTML=e.en,t.innerHTML=e.type,a.innerHTML="<span>meaning</span> "+e.ml,i.classList.add("pos"),$display.appendChild(n),$display.appendChild(t),$display.appendChild(i),l()}else if(e.ml==input.value){$display.style.display="block";n=document.createElement("h3"),t=document.createElement("p"),i=document.createElement("div"),a=document.createElement("p");if(i.appendChild(a),0!=e.other.length)(d=document.createElement("p")).innerHTML="<span>ചാര്‍ച്ചയുള്ളവ</span> "+e.other,i.appendChild(d);if(0!=e.otheren.length)(s=document.createElement("p")).innerHTML="<span>ഉറ്റ ഇംഗ്ലീഷ് വാക്കുകള്‍</span> "+e.otheren,i.appendChild(s);if(0!=e.example.length)(r=document.createElement("p")).innerHTML="<span>എടുത്തുകാട്ടല്‍</span> "+e.example,i.appendChild(r);if(0!=e.MalExplanation)(c=document.createElement("p")).innerHTML="<span> വിവരണം</span> "+e.MalExplanation,i.appendChild(c);if(0!=e.san.length)(o=document.createElement("p")).innerHTML="<span>സംസ്കൃത മലയാളം</span> "+e.san,i.appendChild(o);function l(){"prefix"===e.type?n.innerHTML=e.ml+"-":"suffix"===e.type&&(n.innerHTML="-"+e.ml)}function p(){"noun"===t.innerHTML?t.innerHTML="പേര്":"verb"===t.innerHTML?t.innerHTML="വിന":"adjective"===t.innerHTML&&(t.innerHTML="നാമവിശേഷണം")}i.classList.add("pos"),n.innerHTML=e.ml,t.innerHTML=e.type,a.innerHTML="<span>പൊരുള്‍</span> "+e.en,$display.appendChild(n),$display.appendChild(t),$display.appendChild(i),l(),p()}else if(e.san==input.value){$display.style.display="block";n=document.createElement("h3"),t=document.createElement("p"),i=document.createElement("div"),a=document.createElement("p");if(i.appendChild(a),0!=e.other.length)(d=document.createElement("p")).innerHTML="<span>ചാര്‍ച്ചയുള്ളവ</span> "+e.other,i.appendChild(d);if(0!=e.otheren.length)(s=document.createElement("p")).innerHTML="<span>ഉറ്റ ഇംഗ്ലീഷ് വാക്കുകള്‍</span> "+e.otheren,i.appendChild(s);if(0!=e.example.length)(r=document.createElement("p")).innerHTML="<span>എടുത്തുകാട്ടല്‍</span> "+e.example,i.appendChild(r);if(0!=e.MalExplanation)(c=document.createElement("p")).innerHTML="<span> വിവരണം</span> "+e.MalExplanation,i.appendChild(c);if(0!=e.san.length)(o=document.createElement("p")).innerHTML="<span>സംസ്കൃത മലയാളം</span> "+e.san,i.appendChild(o);function l(){"prefix"===e.type?n.innerHTML=e.ml+"-":"suffix"===e.type&&(n.innerHTML="-"+e.ml)}function p(){"noun"===t.innerHTML?t.innerHTML="പേര്":"verb"===t.innerHTML?t.innerHTML="വിന":"adjective"===t.innerHTML&&(t.innerHTML="നാമവിശേഷണം")}i.classList.add("pos"),n.innerHTML=e.ml,t.innerHTML=e.type,a.innerHTML="<span>പൊരുള്‍</span> "+e.en,$display.appendChild(n),$display.appendChild(t),$display.appendChild(i),l(),p()}else if(e.other==input.value){$display.style.display="block";var d,s,r,c,o;n=document.createElement("h3"),t=document.createElement("p"),i=document.createElement("div"),a=document.createElement("p");if(i.appendChild(a),0!=e.other.length)(d=document.createElement("p")).innerHTML="<span>ചാര്‍ച്ചയുള്ളവ</span> "+e.other,i.appendChild(d);if(0!=e.otheren.length)(s=document.createElement("p")).innerHTML="<span>ഉറ്റ ഇംഗ്ലീഷ് വാക്കുകള്‍</span> "+e.otheren,i.appendChild(s);if(0!=e.example.length)(r=document.createElement("p")).innerHTML="<span>എടുത്തുകാട്ടല്‍</span> "+e.example,i.appendChild(r);if(0!=e.MalExplanation)(c=document.createElement("p")).innerHTML="<span> വിവരണം</span> "+e.MalExplanation,i.appendChild(c);if(0!=e.san.length)(o=document.createElement("p")).innerHTML="<span>സംസ്കൃത മലയാളം</span> "+e.san,i.appendChild(o);function l(){"prefix"===e.type?n.innerHTML=e.ml+"-":"suffix"===e.type&&(n.innerHTML="-"+e.ml)}function p(){"noun"===t.innerHTML?t.innerHTML="പേര്":"verb"===t.innerHTML?t.innerHTML="വിന":"adjective"===t.innerHTML&&(t.innerHTML="നാമവിശേഷണം")}i.classList.add("pos"),n.innerHTML=e.ml,t.innerHTML=e.type,a.innerHTML="<span>പൊരുള്‍</span> "+e.en,$display.appendChild(n),$display.appendChild(t),$display.appendChild(i),l(),p()}}),matches=[],$match.style.display="none",input.value=""})}function chillu(){let e=input.value,n=e.includes("ണ്‍"),t=(e.includes("ന്‍"),e.includes("ര്‍"),e.includes("ല്‍"),e.includes("ള്‍"),e.includes("ക്‍"));if(!0===n){let n=e.split("ണ്‍").join("ണ്");input.value=n}else if(!0===t){let n=e.split("ക്‍").join("ക്");input.value=n}}function enterKey(e){13===e.keyCode&&(findWords(),0===input.value.length&&(input.value="Enter a Word! വാക്ക് തിരയുക",instruction.style.display="block",instruction.innerHTML="Enter a word! വാക്ക് തിരയുക"))}input.addEventListener("input",()=>$filter(input.value)),$submit.addEventListener("click",()=>findWords()),input.addEventListener("input",()=>chillu()),input.addEventListener("input",function(){instruction.innerHTML="",instruction.style.display="none"}),$submit.addEventListener("click",function(){0===input.value.length&&(input.value="Enter a word! വാക്ക് തിരയുക",instruction.style.display="block",instruction.innerHTML="Enter a word! വാക്ക് തിരയുക")});
